# Diccionario de capas de medición basado en el Dataset
# Estructura: {codigo_capa: {logica, precio_unitario, unidad}}

capas_medicion = {
    "M_01.01.01_LEVANTADO PARA CONSERVAR DE LAMPARAS DE TECHO": {
        "logica": "unidad",
        "precio_unitario": 50.18,
        "unidad": "€/ud"
    },
    "M_01.01.02_LEVANTADO PARA CONSERVAR DE PASAMANOS EN CUERDA CON ACCESORIOS": {
        "logica": "unidad",
        "precio_unitario": 16.74,
        "unidad": "€/ud"
    },
    "M_01.01.03_LEVANTADO PARA CONSERVAR DE ENCIMERA DE MARMOL": {
        "logica": "unidad",
        "precio_unitario": 200.60,
        "unidad": "€/ud"
    },
    "M_01.01.04_LEVANTADO PARA CONSERVAR DE INTERRUPTORES DE METAL": {
        "logica": "unidad",
        "precio_unitario": 10.04,
        "unidad": "€/ud"
    },
    "M_01.01.05_LEVANTADO PARA CONSERVAR DE BANERA CON GRIFERIAS": {
        "logica": "unidad",
        "precio_unitario": 83.59,
        "unidad": "€/ud"
    },
    "M_01.01.06_LEVANTADO PARA CONSERVAR DE RADIADORES DE FUNDICION": {
        "logica": "unidad",
        "precio_unitario": 25.08,
        "unidad": "€/ud"
    },
    "M_01.01.07_LEVANTADO PARA CONSERVAR DE GRIFERIAS": {
        "logica": "unidad",
        "precio_unitario": 26.75,
        "unidad": "€/ud"
    },
    "M_01.01.08_LEVANTADO PARA CONSERVAR DE CARPINTERIA INTERIOR (PUERTAS)": {
        "logica": "unidad",
        "precio_unitario": 131.89,
        "unidad": "€/ud"
    },
    "M_01.02.01_DESPEJE Y RETIRADA DE ARMARIOS Y-O MOBILIARIO": {
        "logica": "perimetro_altura",
        "precio_unitario": 1530.59,
        "unidad": "€/m²"
    },
    "M_01.02.02_DESPEJE Y RETIRADA DE ELECTRODOMESTICOS": {
        "logica": "unidad",
        "precio_unitario": 430.94,
        "unidad": "€/ud"
    },
    "M_01.02.03_DESPEJE Y RETIRADA DE ENCIMERAS": {
        "logica": "areas",
        "precio_unitario": 594.40,
        "unidad": "€/m²"
    },
    "M_01.03.01_LEVANTADO DE PUERTAS DE ACCESO": {
        "logica": "unidad",
        "precio_unitario": 66.86,
        "unidad": "€/ud"
    },
    "M_01.03.02_LEVANTADO DE CARPINTERIA INTERIOR DE MADERA": {
        "logica": "perimetro_altura",
        "precio_unitario": 50.18,
        "unidad": "€/m²"
    },
    "M_01.03.03_LEVANTADO DE PANELADOS INTERIORES DE MADERA": {
        "logica": "perimetro_altura",
        "precio_unitario": 21.75,
        "unidad": "€/m²"
    },
    "M_01.03.04_LEVANTADO DE CARPINTERIAS EXTERIORES": {
        "logica": "perimetro_altura",
        "precio_unitario": 30.09,
        "unidad": "€/m²"
    },
    "M_01.03.05_LEVANTADO DE TELA O PAPEL EN MUROS": {
        "logica": "perimetro_altura",
        "precio_unitario": 10.04,
        "unidad": "€/m²"
    },
    "M_01.03.06_LEVANTADO DE CARGADERO SOBRE VENTANA": {
        "logica": "unidad",
        "precio_unitario": 460.65,
        "unidad": "€/ud"
    },
    "M_01.03.07_LEVANTADO DE MOLDURAS - CORNISAS DE ESCAYOLA": {
        "logica": "longitud",
        "precio_unitario": 6.69,
        "unidad": "€/ml"
    },
    "M_01.03.08_LEVANTADO DE MOLDURAS EN PARAMENTOS DE ZONA DE ESCALERAS": {
        "logica": "unidad",
        "precio_unitario": 802.44,
        "unidad": "€/ud"
    },
    "M_01.03.09_LEVANTADO DE CHIMENEAS FRANCESAS": {
        "logica": "unidad",
        "precio_unitario": 217.34,
        "unidad": "€/ud"
    },
    "M_01.03.10_LEVANTADO DE PELDANOS DE ESCALERA DE MADERA": {
        "logica": "unidad",
        "precio_unitario": 33.45,
        "unidad": "€/ud"
    },
    "M_01.03.11_LEVANTADO DE PELDANOS DE ESCALERA DE MARMOL O PIEDRA": {
        "logica": "unidad",
        "precio_unitario": 26.75,
        "unidad": "€/ud"
    },
    "M_01.03.12_LEVANTADO DE ALFOMBRAS": {
        "logica": "areas",
        "precio_unitario": 5.69,
        "unidad": "€/m²"
    },
    "M_01.03.13_LEVANTADO DE MOQUETA": {
        "logica": "areas",
        "precio_unitario": 8.35,
        "unidad": "€/m²"
    },
    "M_01.03.14_LEVANTADO DE PAVIMENTOS DE MADERA": {
        "logica": "areas",
        "precio_unitario": 14.54,
        "unidad": "€/m²"
    },
    "M_01.03.15_LEVANTADO DE PAVIMENTOS DE PIEDRA O MARMOL": {
        "logica": "areas",
        "precio_unitario": 17.03,
        "unidad": "€/m²"
    },
    "M_01.03.16_LEVANTADO DE PAVIMENTOS DE CERAMICOS": {
        "logica": "areas",
        "precio_unitario": 16.06,
        "unidad": "€/m²"
    },
    "M_01.03.17_LEVANTADO DE FALSAS VIGAS DESARROLLO HASTA 1 METRO": {
        "logica": "longitud",
        "precio_unitario": 8.35,
        "unidad": "€/ml"
    },
    "M_01.04.01_LEVANTADO DE MECANISMOS ELECTRICOS Y LUMINARIAS": {
        "logica": "unidad",
        "precio_unitario": 668.70,
        "unidad": "€/ud"
    },
    "M_01.04.02_LEVANTADO DE RADIADORES A MANO": {
        "logica": "unidad",
        "precio_unitario": 1135.32,
        "unidad": "€/ud"
    },
    "M_01.04.03_LEVANTADO DE INSTALACIONES DE FONTANERIA Y DESAGUES": {
        "logica": "unidad",
        "precio_unitario": 482.95,
        "unidad": "€/ud"
    },
    "M_01.04.04_LEVANTADO DE APARATOS SANITARIOS Y GRIFERIAS": {
        "logica": "unidad",
        "precio_unitario": 499.69,
        "unidad": "€/ud"
    },
    "M_01.04.05_LEVANTADO INSTALACION EXISTENTE A-C CON RETIRADA DE MAQUINAS": {
        "logica": "unidad",
        "precio_unitario": 880.45,
        "unidad": "€/ud"
    },
    "M_01.04.06_LEVANTADO DE EQUIPOS RACKS": {
        "logica": "unidad",
        "precio_unitario": 267.50,
        "unidad": "€/ud"
    },
    "M_01.05.01_DEMOLICION TABIQUE FABRICA LADRILLO A MANO": {
        "logica": "perimetro_altura",
        "precio_unitario": 26.75,
        "unidad": "€/m²"
    },
    "M_01.05.02_DEMOLICION TRASDOSADOS INTERIORES": {
        "logica": "perimetro_altura",
        "precio_unitario": 26.75,
        "unidad": "€/m²"
    },
    "M_01.05.03_LEVANTADO DE TABIQUE AUTOPORTANTE": {
        "logica": "perimetro_altura",
        "precio_unitario": 30.09,
        "unidad": "€/m²"
    },
    "M_01.05.04_LEVANTADO DE TABIQUE AUTOPORTANTE DOBLE CANAL": {
        "logica": "perimetro_altura",
        "precio_unitario": 30.09,
        "unidad": "€/m²"
    },
    "M_01.05.05_LEVANTADO DE TRASDOSADO AUTOPORTANTE": {
        "logica": "perimetro_altura",
        "precio_unitario": 30.09,
        "unidad": "€/m²"
    },
    "M_01.05.06_DEMOLICION ALICATADO Y REVESTIMIENTOS MUROS": {
        "logica": "perimetro_altura",
        "precio_unitario": 20.04,
        "unidad": "€/m²"
    },
    "M_01.05.07_DEMOLICION FALSOS TECHOS": {
        "logica": "areas",
        "precio_unitario": 20.04,
        "unidad": "€/m²"
    },
    "M_01.05.08_APERTURA DE HUECO EN MURO FABRICA DE LADRILLO PARA HORNACINA": {
        "logica": "perimetro_altura",
        "precio_unitario": 293.49,
        "unidad": "€/m²"
    },
    "M_01.06.01_DEMOLICION SOPORTE DE TERRAZA": {
        "logica": "areas",
        "precio_unitario": 46.82,
        "unidad": "€/m²"
    },
    "M_01.06.02_DEMOLICION PAVIMENTO Y ZOCALO EXISTENTE TERRAZA": {
        "logica": "areas",
        "precio_unitario": 18.39,
        "unidad": "€/m²"
    },
    "M_01.07.01_DEMOLICION DE SOLERAS H.A.-10cm. CON COMPRESOR": {
        "logica": "areas",
        "precio_unitario": 33.45,
        "unidad": "€/m²"
    },
    "M_01.08.01_DEMOLICION COMPLETA DE EDIFICIO PISCINA Y PISTA DEPORTIVA": {
        "logica": "unidad",
        "precio_unitario": 145751.20,
        "unidad": "€/ud"
    },
    "M_01.09.01_PREPARACION PARAMENTOS SANEADO TAPADO HUECOS Y PINTURA": {
        "logica": "unidad",
        "precio_unitario": 2730.53,
        "unidad": "€/ud"
    },
    "M_02.01.01_DESBROCE Y LIMPIEZA DEL TERRENO": {
        "logica": "areas",
        "precio_unitario": 4.35,
        "unidad": "€/m²"
    },
    "M_02.02.01_EXC.VAC.A MAQUINA TERRENO MEDIA-BLANDA": {
        "logica": "volumen",
        "precio_unitario": 25.61,
        "unidad": "€/m³"
    },
    "M_02.03.01_ZAHORRA RELL-APIS.CIELO AB.MEC.C-APORTE": {
        "logica": "volumen",
        "precio_unitario": 65.76,
        "unidad": "€/m³"
    },
    "M_02.04.01_RELL-COMP.TRASDOS MUROS TIERRAS PROPIAS": {
        "logica": "volumen",
        "precio_unitario": 17.85,
        "unidad": "€/m³"
    },
    "M_02.05.01_RELLENO EN PARCELA Y SOTANO TIERRAS PROPIAS": {
        "logica": "volumen",
        "precio_unitario": 15.05,
        "unidad": "€/m³"
    },
    "M_02.05.02_RELLENO EN PARCELA Y SOTANO CON APORTE DE TIERRAS": {
        "logica": "volumen",
        "precio_unitario": 39.49,
        "unidad": "€/m³"
    },
    "M_02.06.01_EXCAVACION DE ZANJA T.MEDIO C-COMP.": {
        "logica": "volumen",
        "precio_unitario": 56.46,
        "unidad": "€/m³"
    },
    "M_02.06.02_RELLENO DE ZANJAS": {
        "logica": "volumen",
        "precio_unitario": 21.34,
        "unidad": "€/m³"
    },
    "M_03.01.01_REPLANTEO GENERAL CIMENTACION": {
        "logica": "unidad",
        "precio_unitario": 1263.85,
        "unidad": "€/ud"
    },
    "M_03.01.02_HORMIGON LIMPIEZA HL-150-B-20": {
        "logica": "volumen",
        "precio_unitario": 255.92,
        "unidad": "€/m³"
    },
    "M_03.01.03_HORMIGON ARMADO MURO SOTANO 1C 3-H-6 m ESPESOR 30 cm.": {
        "logica": "volumen",
        "precio_unitario": 832.33,
        "unidad": "€/m³"
    },
    "M_03.01.04_LOSA HA-25 E-40 CM": {
        "logica": "volumen",
        "precio_unitario": 791.22,
        "unidad": "€/m³"
    },
    "M_04.01.01_REPLANTEO GENERAL": {
        "logica": "unidad",
        "precio_unitario": 1263.85,
        "unidad": "€/ud"
    },
    "M_04.01.02_PILARES DE HORMIGON ARMADO": {
        "logica": "volumen",
        "precio_unitario": 1173.72,
        "unidad": "€/m³"
    },
    "M_04.01.03_PINTURA ESTRUCTURA INTUMESCENTE R-30": {
        "logica": "perimetro_altura",
        "precio_unitario": 22.97,
        "unidad": "€/m²"
    },
    "M_04.02.01_VIGA DE HORMIGON ARMADO HA-25-B-20-XC1 f": {
        "logica": "volumen",
        "precio_unitario": 872.41,
        "unidad": "€/m³"
    },
    "M_04.03.01_LOSA DE HORMIGON ARMADO HORIZONTAL CANTO 35 cm PL. BAJA": {
        "logica": "areas",
        "precio_unitario": 283.03,
        "unidad": "€/m²"
    },
    "M_04.03.02_LOSA DE HORMIGON ARMADO HORIZONTAL CANTO 35 cm PL. PRIMERA": {
        "logica": "areas",
        "precio_unitario": 325.50,
        "unidad": "€/m²"
    },
    "M_04.03.03_LOSA DE HORMIGON ARMADO HORIZONTAL CANTO 35 cm PL. CUBIERTA": {
        "logica": "areas",
        "precio_unitario": 345.01,
        "unidad": "€/m²"
    },
    "M_04.03.04_LOSA DE HORMIGON ARMADO HORIZONTAL CANTO 25 cm": {
        "logica": "areas",
        "precio_unitario": 302.64,
        "unidad": "€/m²"
    },
    "M_04.04.01_TALADRO FORJADO HORMIGON": {
        "logica": "unidad",
        "precio_unitario": 351.25,
        "unidad": "€/ud"
    },
    "M_04.05.01_HORMIGON LOSA ESCALERA": {
        "logica": "volumen",
        "precio_unitario": 1073.78,
        "unidad": "€/m³"
    },
    "M_04.06.01_ACERO S-275JR ESTRUCTURA AUXILIAR - SECUNDARIA": {
        "logica": "peso",
        "precio_unitario": 4.84,
        "unidad": "€/kg"
    },
    "M_05.01.01_REALIZACION ACOMETIDA RED GRAL.SANEAMIENTO": {
        "logica": "unidad",
        "precio_unitario": 4736.61,
        "unidad": "€/ud"
    },
    "M_05.02.01_SANEAMIENTO - REPOSICION DE AGLOMERADO ASFATICO": {
        "logica": "unidad",
        "precio_unitario": 1006.15,
        "unidad": "€/ud"
    },
    "M_05.03.01_ARQUETA COLECTORA JIMTEN S-431": {
        "logica": "unidad",
        "precio_unitario": 1356.02,
        "unidad": "€/ud"
    },
    "M_05.04.01_SUM. Y MONT. DE ARQUETA PREF. PP 40x40x60 cm.": {
        "logica": "unidad",
        "precio_unitario": 617.80,
        "unidad": "€/ud"
    }
}

# Nota: Este diccionario contiene las primeras 50 partidas del Dataset
# Para incluir todas las 794 partidas, se necesitaría procesar todo el archivo CSV
# y mapear cada partida con su lógica de medición correspondiente
